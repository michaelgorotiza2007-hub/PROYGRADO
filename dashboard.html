<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel | ECUPLATAFORMA</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="toast-container"></div>

    <div id="lockScreen" class="hidden" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(15,23,42,0.98);z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;color:white;text-align:center;">
        <i class="fas fa-lock" style="font-size:5rem; color:#ef4444; margin-bottom:20px; animation:pulseGlow 2s infinite;"></i>
        <h1 style="font-size:2.5rem; font-weight:800; margin-bottom:10px;">ACCESO RESTRINGIDO</h1>
        <p style="color:#cbd5e1; font-size:1.1rem; margin-bottom:40px;">Su cuenta presenta valores pendientes con la institución.</p>
        <div class="glass-panel" style="background:rgba(255,255,255,0.1); padding:40px;">
            <input type="text" id="unlockCode" placeholder="CÓDIGO DE VALIDACIÓN" style="text-align:center; font-size:1.5rem; font-weight:bold; letter-spacing:4px; text-transform:uppercase; background:rgba(0,0,0,0.3); border:1px solid rgba(255,255,255,0.2); color:white; width:100%; margin-bottom:20px;">
            <button class="btn btn-primary" style="width:100%; justify-content:center; font-size:1.1rem;" onclick="window.System.desbloquear()">
                <i class="fas fa-key"></i> Validar Pago
            </button>
        </div>
    </div>

    <div class="layout">
        <aside class="sidebar">
            <div class="brand">
                <i class="fas fa-shapes" style="font-size:1.6rem; margin-right:12px;"></i> ECUPLATAFORMA
            </div>
            
            <div class="user-profile">
                <img id="uPhoto" class="avatar" src="" alt="User">
                <div style="margin-top:10px;">
                    <h4 id="uName" style="margin:0; font-size:1rem; font-weight:700;">Cargando...</h4>
                    <span id="uRole" class="badge bg-green" style="margin-top:5px; display:inline-block;">...</span>
                </div>
            </div>

            <nav id="menuContainer" class="nav"></nav>

            <div style="padding: 24px;">
                <button onclick="window.System.logout()" class="btn btn-danger" style="width:100%; justify-content:center;">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </button>
            </div>
        </aside>

        <div class="main-content">
            <header class="topbar">
                <div>
                    <h2 id="pageTitle" style="font-size:1.5rem; font-weight:800; letter-spacing:-0.5px;">Inicio</h2>
                </div>
                
                <div style="display:flex; gap:20px; align-items:center; position:relative;">
                    <div id="payAlert" class="hidden badge bg-yellow" style="padding:8px 16px; font-size:0.85rem; display:flex; align-items:center; gap:8px;">
                        <i class="fas fa-exclamation-triangle"></i> Pago Pendiente
                    </div>

                    <button class="btn btn-ghost" style="border-radius:50%; width:45px; height:45px; padding:0; justify-content:center; position:relative;" onclick="window.System.toggleNotif()">
                        <i class="far fa-bell" style="font-size:1.2rem;"></i>
                        <div id="notifDot" style="position:absolute; top:10px; right:12px; width:10px; height:10px; background:var(--danger); border-radius:50%; border:2px solid white; display:none;"></div>
                    </button>

                    <div id="notifPanel" class="hidden glass-panel" style="position:absolute; top:65px; right:0; width:340px; padding:0; z-index:100; max-height:400px; overflow-y:auto; background:rgba(255,255,255,0.95);">
                        <div style="padding:16px; border-bottom:1px solid rgba(0,0,0,0.05); font-weight:bold; color:var(--primary);">Notificaciones</div>
                        <div id="notifList"></div>
                    </div>
                </div>
            </header>

            <main id="mainArea" class="content-area">
                <div class="loading"><i class="fas fa-circle-notch fa-spin fa-3x"></i></div>
            </main>
        </div>
    </div>

    <div id="modalOverlay" class="hidden">
        <div class="modal-box">
            <div class="modal-header">
                <h3 id="modalTitle" style="margin:0; font-size:1.3rem; color:var(--primary);">Título</h3>
                <button onclick="window.System.closeModal()" style="background:none; border:none; font-size:1.8rem; color:var(--text-muted); cursor:pointer; line-height:1;">&times;</button>
            </div>
            <div id="modalContent" class="modal-body"></div>
        </div>
    </div>

    <script type="module" src="js/dashboard-logic.js"></script>
</body>
</html>