<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCP | Plataforma Tecnológica</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <div class="tech-background">
        <div class="circuit-overlay"></div>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <div id="loader-screen" class="active">
        <div class="loader-content">
            <div class="spinner-tech"></div>
            <h3>Inicializando Sistema LCP...</h3>
        </div>
    </div>

    <div id="view-login" class="view-container active">
        <div class="glass-panel login-panel">
            <div class="panel-header center">
                <i class="fas fa-shield-alt header-icon"></i>
                <h1>Acceso Seguro LCP</h1>
                <p>Ingrese sus credenciales institucionales</p>
            </div>
            <form id="form-login">
                <div class="tech-input">
                    <i class="fas fa-user-circle"></i>
                    <input type="email" id="login-email" placeholder="Usuario / Correo" required>
                </div>
                <div class="tech-input">
                    <i class="fas fa-fingerprint"></i>
                    <input type="password" id="login-pass" placeholder="Contraseña" required>
                </div>
                <button type="submit" class="btn-tech primary full">Conectar <i class="fas fa-arrow-right"></i></button>
            </form>
            <div class="login-footer">
                <small>Estudiantes: Usen las credenciales entregadas por administración.</small>
            </div>
        </div>
    </div>

    <div id="view-verify" class="view-container">
        <div class="glass-panel verify-panel">
            <i class="fas fa-lock-open header-icon accent"></i>
            <h2>Activación Requerida</h2>
            <p>Hola, <b id="verify-name">Estudiante</b>. Introduce tu Código de Seguridad Único para desbloquear el portal.</p>
            <form id="form-verify">
                <input type="text" id="verify-code" class="code-input" placeholder="XXX-XXXX-XXX" required autocomplete="off">
                <button type="submit" class="btn-tech accent full">Validar Acceso</button>
            </form>
            <button onclick="logout()" class="btn-text">Volver</button>
        </div>
    </div>

    <div id="view-dashboard" class="dashboard-layout">
        
        <aside class="sidebar">
            <div class="brand">
                <i class="fab fa-connectdevelop"></i> <span>LCP Tech</span>
            </div>
            
            <div class="user-card-mini">
                <div class="avatar-hexagon"><span id="dash-avatar">U</span></div>
                <div class="user-details">
                    <h4 id="dash-name">Cargando...</h4>
                    <span id="dash-role" class="badge-role">Rol</span>
                </div>
            </div>

            <nav class="main-menu">
                <p class="menu-label">NAVEGACIÓN</p>

                <ul class="menu-list student-only">
                    <li><a href="#" onclick="loadSection('stu-overview')" class="active"><i class="fas fa-th-large"></i> Panel General</a></li>
                    <li><a href="#" onclick="loadSection('stu-classes')"><i class="fas fa-chalkboard"></i> Mis Clases</a></li>
                    <li><a href="#" onclick="loadSection('stu-tasks')"><i class="fas fa-tasks"></i> Tareas</a></li>
                    <li><a href="#" onclick="loadSection('stu-attendance')"><i class="fas fa-clock"></i> Asistencias</a></li>
                    <li><a href="#" onclick="loadSection('stu-behavior')"><i class="fas fa-user-tag"></i> Comportamiento</a></li>
                    <li><a href="#" onclick="loadSection('stu-grades')"><i class="fas fa-book"></i> Cuaderno de Notas</a></li>
                    <li><a href="#" onclick="loadSection('stu-reports')"><i class="fas fa-file-signature"></i> Evaluaciones y Exámenes</a></li>
                </ul>

                <ul class="menu-list teacher-only">
                    <li><a href="#" onclick="loadSection('tea-home')" class="active"><i class="fas fa-home"></i> Inicio Docente</a></li>
                    <li><a href="#" onclick="loadSection('tea-courses')"><i class="fas fa-chalkboard-teacher"></i> Mis Cursos (Gestión)</a></li>
                    <li><a href="#" onclick="loadSection('tea-ai')"><i class="fas fa-microchip"></i> Asistente IA (Exámenes)</a></li>
                </ul>

                <ul class="menu-list admin-only">
                    <li><a href="#" onclick="loadSection('adm-register')" class="active"><i class="fas fa-user-plus"></i> Matriculación</a></li>
                    <li><a href="#" onclick="loadSection('adm-list-stu')"><i class="fas fa-users"></i> Lista Estudiantes</a></li>
                    <li><a href="#" onclick="loadSection('adm-list-tea')"><i class="fas fa-chalkboard-teacher"></i> Lista Docentes</a></li>
                    <li><a href="#" onclick="loadSection('adm-grades')"><i class="fas fa-chart-line"></i> Rendimiento Global</a></li>
                    <li><a href="#" onclick="loadSection('adm-ai')"><i class="fas fa-brain"></i> Análisis IA Institucional</a></li>
                </ul>
            </nav>

            <div class="sidebar-footer">
                <button onclick="logout()" class="btn-logout"><i class="fas fa-power-off"></i> Cerrar Sesión</button>
            </div>
        </aside>

        <main class="content-area">
            <header class="topbar">
                <h2 id="section-title">Vista General</h2>
                <div class="top-actions">
                    <div class="icon-wrapper" onclick="toggleDropdown('notif-drop')">
                        <i class="far fa-bell"></i>
                        <span class="notification-dot" id="notif-badge" style="display:none"></span>
                        <div class="dropdown-glass" id="notif-drop">
                            <div class="drop-header">Notificaciones Recientes</div>
                            <div class="drop-body" id="notif-list">
                                <p class="empty-state">Sin novedades.</p>
                            </div>
                        </div>
                    </div>
                    <div class="icon-wrapper" onclick="toggleDropdown('msg-drop')">
                        <i class="far fa-envelope"></i>
                        <div class="dropdown-glass" id="msg-drop">
                            <div class="drop-header">Bandeja de Entrada</div>
                            <div class="drop-body">
                                <p class="empty-state">No hay mensajes nuevos.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="workspace-scroll">
                
                <section id="stu-overview" class="workspace-section active">
                    <div class="glass-panel profile-overview">
                        <div class="profile-image-container">
                            <img src="https://ui-avatars.com/api/?name=Estudiante&background=0ea5e9&color=fff&size=128" id="stu-photo" alt="Perfil">
                            <div class="status-indicator online"></div>
                        </div>
                        <div class="profile-data-tech">
                            <h2 id="stu-fullname-display">Cargando datos...</h2>
                            <div class="data-chips">
                                <div class="chip"><i class="fas fa-layer-group"></i> Curso: <b id="stu-course-display">--</b></div>
                                <div class="chip"><i class="fas fa-columns"></i> Paralelo: <b>A</b></div>
                                <div class="chip"><i class="fas fa-calendar-alt"></i> Año Lectivo: <b>2025-2026</b></div>
                                <div class="chip"><i class="fas fa-venus-mars"></i> Género: <b id="stu-gender-display">--</b></div>
                                <div class="chip"><i class="fas fa-birthday-cake"></i> Edad: <b id="stu-age-display">--</b></div>
                            </div>
                        </div>
                    </div>

                    <div class="glass-panel calendar-panel">
                        <div class="panel-header">
                            <h3><i class="far fa-calendar-alt"></i> Agenda del Mes</h3>
                            <span class="date-display">Enero 2026</span>
                        </div>
                        <div class="calendar-tech-grid" id="calendar-grid">
                            </div>
                    </div>
                </section>

                <section id="stu-grades" class="workspace-section">
                    <div class="glass-panel">
                        <div class="panel-header"><h3>Cuaderno de Notas Detallado</h3></div>
                        <div class="table-container">
                            <table class="tech-table">
                                <thead><tr><th>Materia</th><th>P1</th><th>P2</th><th>Examen</th><th>Promedio</th></tr></thead>
                                <tbody>
                                    <tr><td>Matemáticas</td><td>9.5</td><td>8.0</td><td>-</td><td>8.75</td></tr>
                                    <tr><td>Lenguaje</td><td>10</td><td>9.5</td><td>-</td><td>9.75</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <section id="adm-register" class="workspace-section">
                    <div class="glass-panel">
                         <div class="panel-header">
                            <h3><i class="fas fa-file-contract"></i> Ficha de Matriculación Integral</h3>
                            <p>Complete todos los campos para generar el acceso del estudiante.</p>
                        </div>
                        
                        <form id="form-matricula-completa">
                            <div class="form-divider">
                                <span><i class="fas fa-user-graduate"></i> Datos del Estudiante</span>
                            </div>
                            <div class="grid-3">
                                <input type="text" id="mat-stu-cedula" placeholder="Cédula de Identidad" class="tech-input-field" required>
                                <input type="text" id="mat-stu-name" placeholder="Nombres Completos" class="tech-input-field" required>
                                <input type="text" id="mat-stu-last" placeholder="Apellidos Completos" class="tech-input-field" required>
                                
                                <div class="input-group-tech">
                                    <label>Fecha de Nacimiento</label>
                                    <input type="date" id="mat-stu-dob" class="tech-input-field" onchange="calculateAge()" required>
                                </div>
                                <input type="text" id="mat-stu-age" placeholder="Edad Automática" class="tech-input-field readonly" readonly>
                                
                                <select id="mat-stu-gender" class="tech-input-field" required>
                                    <option value="" disabled selected>Sexo</option>
                                    <option value="M">Masculino</option>
                                    <option value="F">Femenino</option>
                                </select>

                                <input type="email" id="mat-stu-email-personal" placeholder="Correo Personal (Opcional)" class="tech-input-field">
                                <input type="tel" id="mat-stu-phone" placeholder="Teléfono Celular" class="tech-input-field">
                                <input type="text" id="mat-stu-nacionalidad" placeholder="Nacionalidad" class="tech-input-field">
                                <input type="text" id="mat-stu-ciudad-nac" placeholder="Ciudad de Nacimiento" class="tech-input-field">
                                
                                <select id="mat-stu-course" class="tech-input-field highlight-input" required>
                                    <option value="" disabled selected>Asignar Curso</option>
                                    <option value="8vo EGB">8vo EGB</option>
                                    <option value="9no EGB">9no EGB</option>
                                    <option value="1ero Bach">1ero Bachillerato</option>
                                </select>
                            </div>

                            <div class="form-divider mt-4">
                                <span><i class="fas fa-user-tie"></i> Datos del Representante Legal</span>
                            </div>
                            <div class="grid-3">
                                <input type="text" id="mat-rep-cedula" placeholder="Cédula Representante" class="tech-input-field" required>
                                <input type="text" id="mat-rep-name" placeholder="Nombres" class="tech-input-field" required>
                                <input type="text" id="mat-rep-last" placeholder="Apellidos" class="tech-input-field" required>

                                <input type="date" placeholder="Fecha Nacimiento" class="tech-input-field">
                                <input type="email" id="mat-rep-email" placeholder="Correo Electrónico (Obligatorio)" class="tech-input-field" required>
                                <input type="tel" placeholder="Teléfono Celular" class="tech-input-field" required>

                                <input type="text" placeholder="Nacionalidad" class="tech-input-field">
                                <input type="text" placeholder="Ciudad Nacimiento" class="tech-input-field">
                                <input type="text" placeholder="Religión (Opcional)" class="tech-input-field">

                                <select class="tech-input-field">
                                    <option value="">Estado Civil</option>
                                    <option>Soltero/a</option><option>Casado/a</option><option>Divorciado/a</option><option>Viudo/a</option>
                                </select>
                                <input type="text" placeholder="Nivel de Educación (Opcional)" class="tech-input-field">
                                <input type="text" placeholder="Ciudad de Residencia" class="tech-input-field">

                                <input type="text" placeholder="Dirección de Domicilio Completa" class="tech-input-field span-2" required>
                                <input type="tel" placeholder="Teléfono Domicilio (Opcional)" class="tech-input-field">
                            </div>

                            <button type="submit" class="btn-tech primary full mt-4" id="btn-matricular">
                                <i class="fas fa-save"></i> Procesar Matrícula y Generar Credenciales
                            </button>
                        </form>

                        <div id="credentials-result" class="glass-panel success-panel mt-4" style="display: none;">
                            <h4><i class="fas fa-check-circle"></i> Matrícula Exitosa</h4>
                            <p>Entregue los siguientes datos al estudiante para su primer ingreso:</p>
                            <div class="credentials-box">
                                <div class="cred-item">
                                    <label>Usuario Institucional:</label>
                                    <span id="res-user">cargando...</span>
                                </div>
                                <div class="cred-item">
                                    <label>Contraseña Temporal:</label>
                                    <span id="res-pass">cargando...</span>
                                </div>
                                <div class="cred-item highlight">
                                    <label>CÓDIGO DE SEGURIDAD:</label>
                                    <span id="res-code">XXXX-XXXX</span>
                                </div>
                            </div>
                            <button onclick="this.parentElement.style.display='none'" class="btn-tech secondary">Cerrar</button>
                        </div>

                    </div>
                </section>

                <section id="tea-ai" class="workspace-section">
                    <div class="ai-interface glass-panel">
                        <div class="ai-sidebar">
                             <div class="ai-brand"><i class="fas fa-brain"></i> Gemini Edu</div>
                             <p>Herramientas de IA para docentes y administrativos.</p>
                        </div>
                        <div class="ai-chat-area">
                            <div class="chat-messages" id="ai-chat-output">
                                <div class="ai-message system">
                                    <i class="fas fa-robot"></i>
                                    <p>Hola. Puedo ayudarte a crear exámenes, rúbricas o analizar el rendimiento. Escribe tu solicitud.</p>
                                </div>
                            </div>
                            <div class="chat-input-box">
                                <textarea id="ai-prompt" placeholder="Ej: Crea 3 preguntas de opción múltiple sobre la tabla periódica para 10mo año..."></textarea>
                                <button onclick="callGeminiApi()" id="btn-ai-send"><i class="fas fa-paper-plane"></i></button>
                            </div>
                        </div>
                    </div>
                </section>

            </div> </main>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>